{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '24152486-dede519cf70640e98e72cca28';\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport default async function fetchPic(\n  searchParam,\n  page = 1,\n  perPage = 15,\n  imageType = 'photo',\n  orientation = 'horizontal',\n  safesearch = true\n) {\n  const result = await axios.get(`/`, {\n    params: {\n      key: API_KEY,\n      q: searchParam,\n      page,\n      per_page: perPage,\n      image_type: imageType,\n      orientation,\n      safesearch,\n    },\n  });\n\n  return result.data;\n}\n","export default function renderGallery(picArr) {\n  let galleryComplete = '';\n  picArr.map(item => {\n    const {\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = item;\n\n    galleryComplete += `<li class='gallery_item'>\n    <a href='${largeImageURL}' target=\"_blank\">\n      <img src='${webformatURL}' alt='${tags}' class='gallery_img'/>\n      <div class='gallery_info_wrapper'>\n        <p class='gallery_info'>Likes <span>${likes}</span></p>\n        <p class='gallery_info'>Views <span>${views}</span></p>\n        <p class='gallery_info'>Comments <span>${comments}</span></p>\n        <p class='gallery_info'>Downloads <span>${downloads}</span></p>\n      </div>\n    </a>\n    </li>`;\n  });\n\n  return galleryComplete;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport fetchPic from './js/pixabay-api';\nimport renderGallery from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst formInput = document.querySelector('.form_input');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('#load_more_btn');\n\nlet curPage = 1;\nlet searchParam = '';\nconst perPage = 12;\n\nlet simplelightbox = new SimpleLightbox('.gallery_item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n\n  searchParam = formInput.value.trim();\n\n  if (searchParam === '') {\n    iziToast.error({\n      message: 'Search value is empty',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  gallery.innerHTML = ''; //cleanup prev gallery\n  gallery.classList.add('hidden');\n  loadMoreBtn.classList.add('hidden');\n  loader.classList.remove('hidden');\n\n  fetchPic(searchParam, curPage, perPage)\n    .then(data => {\n      formInput.value = '';\n      if (data.hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n        loader.classList.add('hidden');\n        gallery.classList.remove('hidden');\n        return;\n      }\n\n      const galleryLoaded = renderGallery(data.hits);\n      gallery.insertAdjacentHTML('beforeend', galleryLoaded);\n      simplelightbox.refresh();\n      loadMoreBtn.classList.remove('hidden');\n    })\n    .catch(error => {\n      iziToast.error({\n        message: `${error.message || 'Something went wrong!'}`,\n        position: 'topRight',\n      });\n    })\n    .finally(() => {\n      loader.classList.add('hidden');\n      gallery.classList.remove('hidden');\n    });\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loadMoreBtn.classList.add('hidden');\n  loader.classList.remove('hidden');\n\n  curPage += 1;\n\n  try {\n    const data = await fetchPic(searchParam, curPage, perPage);\n    const addToGallery = renderGallery(data.hits);\n    gallery.insertAdjacentHTML('beforeend', addToGallery);\n    loader.classList.add('hidden');\n    scrollUp();\n    showMoreBtn(curPage, perPage, data.totalHits);\n    simplelightbox.refresh();\n  } catch (error) {\n    loader.classList.add('hidden');\n    console.error(error.message);\n  }\n});\n\nfunction showMoreBtn(curPage, perPage, total) {\n  const totalPages = Math.ceil(total / perPage);\n  if (curPage > totalPages) {\n    return iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  scrollUp();\n  loadMoreBtn.classList.remove('hidden');\n}\n\nfunction scrollUp() {\n  const cardHeight =\n    document.querySelector('.gallery_item')?.getBoundingClientRect().height ||\n    0;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","axios","fetchPic","searchParam","page","perPage","imageType","orientation","safesearch","renderGallery","picArr","galleryComplete","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","formInput","gallery","loader","loadMoreBtn","curPage","simplelightbox","SimpleLightbox","e","iziToast","data","galleryLoaded","error","addToGallery","scrollUp","showMoreBtn","total","totalPages","cardHeight"],"mappings":"+vBAEA,MAAMA,EAAU,qCAChBC,EAAM,SAAS,QAAU,0BAEV,eAAeC,EAC5BC,EACAC,EAAO,EACPC,EAAU,GACVC,EAAY,QACZC,EAAc,aACdC,EAAa,GACb,CAaA,OAZe,MAAMP,EAAM,IAAI,IAAK,CAClC,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,KAAAC,EACA,SAAUC,EACV,WAAYC,EACZ,YAAAC,EACA,WAAAC,CACN,CACA,CAAG,GAEa,IAChB,CC1Be,SAASC,EAAcC,EAAQ,CAC5C,IAAIC,EAAkB,GACtB,OAAAD,EAAO,IAAIE,GAAQ,CACjB,KAAM,CACJ,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACN,EAAQP,EAEJD,GAAmB;AAAA,eACRG,CAAa;AAAA,kBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA,8CAEEC,CAAK;AAAA,8CACLC,CAAK;AAAA,iDACFC,CAAQ;AAAA,kDACPC,CAAS;AAAA;AAAA;AAAA,UAIzD,CAAC,EAEMR,CACT,CCpBA,MAAMS,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAU,EACVtB,EAAc,GAClB,MAAME,EAAU,GAEhB,IAAIqB,EAAiB,IAAIC,EAAe,kBAAmB,CACzD,aAAc,MACd,aAAc,GAChB,CAAC,EAEDP,EAAK,iBAAiB,SAAUQ,GAAK,CAKnC,GAJAA,EAAE,eAAc,EAEhBzB,EAAckB,EAAU,MAAM,KAAI,EAE9BlB,IAAgB,GAAI,CACtB0B,EAAS,MAAM,CACb,QAAS,wBACT,SAAU,UAChB,CAAK,EACD,MACF,CAEAP,EAAQ,UAAY,GACpBA,EAAQ,UAAU,IAAI,QAAQ,EAC9BE,EAAY,UAAU,IAAI,QAAQ,EAClCD,EAAO,UAAU,OAAO,QAAQ,EAEhCrB,EAASC,EAAasB,EAASpB,CAAO,EACnC,KAAKyB,GAAQ,CAEZ,GADAT,EAAU,MAAQ,GACdS,EAAK,KAAK,SAAW,EAAG,CAC1BD,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UACpB,CAAS,EACDN,EAAO,UAAU,IAAI,QAAQ,EAC7BD,EAAQ,UAAU,OAAO,QAAQ,EACjC,MACF,CAEA,MAAMS,EAAgBtB,EAAcqB,EAAK,IAAI,EAC7CR,EAAQ,mBAAmB,YAAaS,CAAa,EACrDL,EAAe,QAAO,EACtBF,EAAY,UAAU,OAAO,QAAQ,CACvC,CAAC,EACA,MAAMQ,GAAS,CACdH,EAAS,MAAM,CACb,QAAS,GAAGG,EAAM,SAAW,uBAAuB,GACpD,SAAU,UAClB,CAAO,CACH,CAAC,EACA,QAAQ,IAAM,CACbT,EAAO,UAAU,IAAI,QAAQ,EAC7BD,EAAQ,UAAU,OAAO,QAAQ,CACnC,CAAC,CACL,CAAC,EAEDE,EAAY,iBAAiB,QAAS,SAAY,CAChDA,EAAY,UAAU,IAAI,QAAQ,EAClCD,EAAO,UAAU,OAAO,QAAQ,EAEhCE,GAAW,EAEX,GAAI,CACF,MAAMK,EAAO,MAAM5B,EAASC,EAAasB,EAASpB,CAAO,EACnD4B,EAAexB,EAAcqB,EAAK,IAAI,EAC5CR,EAAQ,mBAAmB,YAAaW,CAAY,EACpDV,EAAO,UAAU,IAAI,QAAQ,EAC7BW,EAAQ,EACRC,EAAYV,EAASpB,EAASyB,EAAK,SAAS,EAC5CJ,EAAe,QAAO,CACxB,OAASM,EAAO,CACdT,EAAO,UAAU,IAAI,QAAQ,EAC7B,QAAQ,MAAMS,EAAM,OAAO,CAC7B,CACF,CAAC,EAED,SAASG,EAAYV,EAASpB,EAAS+B,EAAO,CAC5C,MAAMC,EAAa,KAAK,KAAKD,EAAQ/B,CAAO,EAC5C,GAAIoB,EAAUY,EACZ,OAAOR,EAAS,KAAK,CACnB,SAAU,WACV,QAAS,4DACf,CAAK,EAGHK,EAAQ,EACRV,EAAY,UAAU,OAAO,QAAQ,CACvC,CAEA,SAASU,GAAW,CAClB,MAAMI,EACJ,SAAS,cAAc,eAAe,GAAG,sBAAqB,EAAG,QACjE,EAEF,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}